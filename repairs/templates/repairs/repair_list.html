{% extends 'base.html' %}

{% block content %}
    <h2>Список ремонтів</h2>

    <form method="get">

        <label for="status-filter">Фільтр по статусу:</label>
        <select name="status" id="status-filter">
            <option value="">Всі статуси</option>
            {% for value, display_name in status_choices %}
                <option value="{{ value }}" {% if current_filter == value %}selected{% endif %}>
                    {{ display_name }}
                </option>
            {% endfor %}
        </select>

        <button type="submit">Фільтрувати</button>
    </form>

    <table>
        <thead>
            <tr>
                <th>Авто</th>
                <th>Опис</th>
                <th>Статус</th>
                <th>Дата початку</th>
                <th>Дії</th> </tr>
        </thead>
        <tbody>
            {% for repair in repairs %}
            <tr>
                <td>{{ repair.car }}</td>
                <td>{{ repair.description }}</td>
                <td>{{ repair.get_status_display }}</td>
                <td>{{ repair.start_date|date:"d.m.Y H:i" }}</td>
                <td>
                    <a href="{% url 'generate_invoice' repair.id %}">PDF</a> |
                    <a href="{% url 'send_invoice' repair.id %}">Email</a>
                </td>
            </tr>
            {% empty %}
            <tr><td colspan="5" style="text-align: center;">Ремонтів не знайдено.</td></tr>
            {% endfor %}
        </tbody>
    </table>
{% endblock %}