{% extends 'base.html' %}

{% block content %}
<style>
    /* –ê–Ω—ñ–º–∞—Ü—ñ—è –¥–ª—è –∫–∞—Ä—Ç–æ–∫ */
    .stat-card {
        transition: all 0.3s ease;
    }
    .stat-card:hover {
        transform: translateY(-7px); /* –ü—ñ–¥–Ω—ñ–º–∞—î –∫–∞—Ä—Ç–∫—É –≤–≥–æ—Ä—É */
        border-color: #D60000 !important; /* –ó–º—ñ–Ω—é—î –∫–æ–ª—ñ—Ä —Ä–∞–º–∫–∏ –Ω–∞ —á–µ—Ä–≤–æ–Ω–∏–π */
        box-shadow: 0 10px 20px rgba(214, 0, 0, 0.2); /* –î–æ–¥–∞—î —á–µ—Ä–≤–æ–Ω—É —Ç—ñ–Ω—å */
        cursor: pointer;
    }
</style>

<div class="fade-in">

    <!-- –°–ï–ö–¶–Ü–Ø 1: HERO –ë–ê–ù–ï–† -->
    <div style="position: relative; background: linear-gradient(90deg, #1a1a1a 0%, #000000 100%); padding: 50px; border-radius: 12px; margin-bottom: 40px; border: 1px solid #333; overflow: hidden;">
        <div style="position: absolute; top: 0; left: 0; bottom: 0; width: 6px; background: #D60000;"></div>
        <div style="position: relative; z-index: 2; max-width: 700px;">
            <span style="background: rgba(214, 0, 0, 0.2); color: #ff4444; padding: 6px 12px; border-radius: 4px; font-size: 12px; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; border: 1px solid rgba(214, 0, 0, 0.3);">
                –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –°–¢–û
            </span>
            <h1 style="font-size: 42px; font-weight: 900; margin: 20px 0; line-height: 1.2; text-transform: uppercase;">
                –®–≤–∏–¥–∫–∏–π —Ç–∞ <span style="color: #D60000;">—è–∫—ñ—Å–Ω–∏–π</span><br>—Ä–µ–º–æ–Ω—Ç –≤–∞—à–æ–≥–æ –∞–≤—Ç–æ
            </h1>
            <div style="display: flex; gap: 15px; margin-top: 30px;">
                <a href="{% url 'add_car' %}" style="background: #D60000; color: white; padding: 15px 30px; text-decoration: none; border-radius: 6px; font-weight: bold; text-transform: uppercase; font-size: 12px;">
                    + –î–æ–¥–∞—Ç–∏ –∞–≤—Ç–æ
                </a>
                <a href="{% url 'repair_list' %}" style="border: 1px solid #555; color: white; padding: 15px 30px; text-decoration: none; border-radius: 6px; font-weight: bold; text-transform: uppercase; font-size: 12px;">
                    –í—Å—ñ —Ä–µ–º–æ–Ω—Ç–∏
                </a>
            </div>
        </div>
    </div>

    <!-- –°–ï–ö–¶–Ü–Ø 2: –ü–ê–ù–ï–õ–¨ –ö–ï–†–£–í–ê–ù–ù–Ø (3 –ö–ê–†–¢–ö–ò) -->
    <div style="margin-bottom: 20px; border-left: 4px solid #D60000; padding-left: 15px;">
        <h2 style="font-size: 24px; text-transform: uppercase; margin: 0; font-weight: 800;">–ü–∞–Ω–µ–ª—å –∫–µ—Ä—É–≤–∞–Ω–Ω—è</h2>
    </div>

    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 25px; margin-bottom: 50px;">

        <!-- –ö–∞—Ä—Ç–∫–∞ 1: –ù–æ–≤–µ –∞–≤—Ç–æ -->
        <div class="stat-card" style="background: #1a1a1a; padding: 25px; border-radius: 8px; border: 1px solid #333;">
            <div style="width: 50px; height: 50px; background: #2d2d2d; border-radius: 8px; display: flex; align-items: center; justify-content: center; margin-bottom: 20px;">
                <span style="font-size: 24px;">‚ûï</span>
            </div>
            <h3 style="margin: 0 0 10px 0; font-size: 18px;">–ù–û–í–ï –ê–í–¢–û</h3>
            <p style="color: #666; font-size: 13px; margin-bottom: 20px;">–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ –∑–∞—Å–æ–±—É</p>
            <a href="{% url 'add_car' %}" style="color: #D60000; font-weight: 700; font-size: 12px; text-decoration: none; text-transform: uppercase;">–î–æ–¥–∞—Ç–∏ –¥–æ –±–∞–∑–∏ &rarr;</a>
        </div>

        <!-- –ö–∞—Ä—Ç–∫–∞ 2: –ë–∞–∑–∞ –∞–≤—Ç–æ -->
        <div class="stat-card" style="background: #1a1a1a; padding: 25px; border-radius: 8px; border: 1px solid #333;">
            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 20px;">
                <div style="width: 50px; height: 50px; background: #2d2d2d; border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                    <span style="font-size: 24px;">üöó</span>
                </div>
                <span style="font-size: 32px; font-weight: 700; color: #fff;">{{ total_cars }}</span>
            </div>
            <h3 style="margin: 0 0 10px 0; font-size: 18px;">–ë–ê–ó–ê –ê–í–¢–û</h3>
            <p style="color: #666; font-size: 13px; margin-bottom: 20px;">–í—Å—ñ –∫–ª—ñ—î–Ω—Ç—Å—å–∫—ñ –∞–≤—Ç–æ</p>
            <a href="{% url 'car_list' %}" style="color: #D60000; font-weight: 700; font-size: 12px; text-decoration: none; text-transform: uppercase;">–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ —Å–ø–∏—Å–æ–∫ &rarr;</a>
        </div>

        <!-- –ö–∞—Ä—Ç–∫–∞ 3: –†–µ–º–æ–Ω—Ç–∏ -->
        <div class="stat-card" style="background: #1a1a1a; padding: 25px; border-radius: 8px; border: 1px solid #333;">
            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 20px;">
                <div style="width: 50px; height: 50px; background: #2d2d2d; border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                    <span style="font-size: 24px;">üîß</span>
                </div>
                <span style="font-size: 32px; font-weight: 700; color: #fff;">{{ in_progress }}</span>
            </div>
            <h3 style="margin: 0 0 10px 0; font-size: 18px;">–†–ï–ú–û–ù–¢–ò</h3>
            <p style="color: #666; font-size: 13px; margin-bottom: 20px;">–ê–∫—Ç–∏–≤–Ω—ñ –∑–∞—è–≤–∫–∏ —Ç–∞ —ñ—Å—Ç–æ—Ä—ñ—è</p>
            <a href="{% url 'repair_list' %}" style="color: #D60000; font-weight: 700; font-size: 12px; text-decoration: none; text-transform: uppercase;">–í—ñ–¥–∫—Ä–∏—Ç–∏ –∂—É—Ä–Ω–∞–ª &rarr;</a>
        </div>

    </div>

    <!-- –°–ï–ö–¶–Ü–Ø 3: –û–°–¢–ê–ù–ù–Ü –†–ï–ú–û–ù–¢–ò (–¢–ê–ë–õ–ò–¶–Ø) -->
    <div style="margin-bottom: 20px; border-left: 4px solid #D60000; padding-left: 15px;">
        <h2 style="font-size: 20px; text-transform: uppercase; margin: 0; font-weight: 700; color: #ccc;">–û—Å—Ç–∞–Ω–Ω—ñ —Ä–µ–º–æ–Ω—Ç–∏</h2>
    </div>

    <div style="background: #1a1a1a; border-radius: 8px; border: 1px solid #333; overflow: hidden;">
        <table style="width: 100%; border-collapse: collapse; font-size: 13px;">
            <thead>
                <tr style="background: #252525;">
                    <th style="padding: 15px 20px; text-align: left; color: #666; text-transform: uppercase; font-size: 11px; letter-spacing: 1px;">–ê–í–¢–û</th>
                    <th style="padding: 15px 20px; text-align: left; color: #666; text-transform: uppercase; font-size: 11px; letter-spacing: 1px;">VIN (–æ—Å—Ç. 6)</th>
                    <th style="padding: 15px 20px; text-align: left; color: #666; text-transform: uppercase; font-size: 11px; letter-spacing: 1px;">–í–õ–ê–°–ù–ò–ö</th>
                    <th style="padding: 15px 20px; text-align: left; color: #666; text-transform: uppercase; font-size: 11px; letter-spacing: 1px;">–°–¢–ê–¢–£–°</th>
                    <th style="padding: 15px 20px; text-align: right; color: #666; text-transform: uppercase; font-size: 11px; letter-spacing: 1px;">–î–ê–¢–ê</th>
                </tr>
            </thead>
            <tbody>
                <!-- –í–∏–≤–æ–¥–∏–º–æ —Å–ø–∏—Å–æ–∫ —Ä–µ–º–æ–Ω—Ç—ñ–≤ (recent_repairs) -->
                {% for repair in recent_repairs %}
                <tr style="border-bottom: 1px solid #222;">
                    <td style="padding: 15px 20px; color: #fff; font-weight: 700;">
                        {{ repair.car.make }} {{ repair.car.model_name }}
                    </td>
                    <td style="padding: 15px 20px; color: #888; font-family: monospace;">
                        ...{{ repair.car.vin|slice:"-6:" }}
                    </td>
                    <td style="padding: 15px 20px; color: #bbb;">
                        {{ repair.car.owner_name }}
                    </td>
                    <td style="padding: 15px 20px;">
                        {% if repair.status == 'new' %}
                            <span style="color: #ffc107; font-weight: 600;">‚óè –ù–æ–≤–∏–π</span>
                        {% elif repair.status == 'in_progress' %}
                            <span style="color: #3b82f6; font-weight: 600;">‚óè –í —Ä–æ–±–æ—Ç—ñ</span>
                        {% elif repair.status == 'completed' %}
                            <span style="color: #22c55e; font-weight: 600;">‚óè –ì–æ—Ç–æ–≤–æ</span>
                        {% else %}
                            <span style="color: #888;">{{ repair.get_status_display }}</span>
                        {% endif %}
                    </td>
                    <td style="padding: 15px 20px; text-align: right; color: #666;">
                        {{ repair.start_date|date:"d.m.Y" }}
                    </td>
                </tr>
                {% empty %}

                <!-- –ó–ê–ì–õ–£–®–ö–ê (–î–ï–ú–û –î–ê–ù–Ü) -->
                <!-- –ê–≤—Ç–æ 1: Ford -->
                <tr style="border-bottom: 1px solid #222; opacity: 0.6;">
                    <td style="padding: 15px 20px; color: #fff; font-weight: 700;">
                        Ford Fusion
                    </td>
                    <td style="padding: 15px 20px; color: #888; font-family: monospace;">
                        ...159753
                    </td>
                    <td style="padding: 15px 20px; color: #bbb;">
                        –ö—Ä–∞–≤—á–µ–Ω–∫–æ –î–º–∏—Ç—Ä–æ
                    </td>
                    <td style="padding: 15px 20px;">
                        <span style="color: #ffc107; font-weight: 600;">‚óè –ù–æ–≤–∏–π</span>
                    </td>
                    <td style="padding: 15px 20px; text-align: right; color: #666;">
                        04.12.2025
                    </td>
                </tr>

                <!-- –ê–≤—Ç–æ 2: Skoda -->
                <tr style="border-bottom: 1px solid #222; opacity: 0.6;">
                    <td style="padding: 15px 20px; color: #fff; font-weight: 700;">
                        Skoda Octavia
                    </td>
                    <td style="padding: 15px 20px; color: #888; font-family: monospace;">
                        ...009987
                    </td>
                    <td style="padding: 15px 20px; color: #bbb;">
                        –ë–æ–π–∫–æ –Æ–ª—ñ—è
                    </td>
                    <td style="padding: 15px 20px;">
                        <span style="color: #22c55e; font-weight: 600;">‚óè –ì–æ—Ç–æ–≤–æ</span>
                    </td>
                    <td style="padding: 15px 20px; text-align: right; color: #666;">
                        04.12.2025
                    </td>
                </tr>

                <!-- –ê–≤—Ç–æ 3: Nissan -->
                <tr style="border-bottom: 1px solid #222; opacity: 0.6;">
                    <td style="padding: 15px 20px; color: #fff; font-weight: 700;">
                        Nissan Rogue
                    </td>
                    <td style="padding: 15px 20px; color: #888; font-family: monospace;">
                        ...123456
                    </td>
                    <td style="padding: 15px 20px; color: #bbb;">
                        –õ–∏—Ç–≤–∏–Ω –°–µ—Ä–≥—ñ–π
                    </td>
                    <td style="padding: 15px 20px;">
                        <span style="color: #3b82f6; font-weight: 600;">‚óè –í —Ä–æ–±–æ—Ç—ñ</span>
                    </td>
                    <td style="padding: 15px 20px; text-align: right; color: #666;">
                        04.12.2025
                    </td>
                </tr>

                <!-- –ê–≤—Ç–æ 4: Renault -->
                <tr style="border-bottom: 1px solid #222; opacity: 0.6;">
                    <td style="padding: 15px 20px; color: #fff; font-weight: 700;">
                        Renault Megane
                    </td>
                    <td style="padding: 15px 20px; color: #888; font-family: monospace;">
                        ...543322
                    </td>
                    <td style="padding: 15px 20px; color: #bbb;">
                        –¢–∫–∞—á—É–∫ –í—ñ—Ç–∞–ª—ñ–π
                    </td>
                    <td style="padding: 15px 20px;">
                         <span style="color: #888; font-weight: 600;">‚óè –û—á—ñ–∫—É—î –∑–∞–ø—á–∞—Å—Ç–∏–Ω</span>
                    </td>
                    <td style="padding: 15px 20px; text-align: right; color: #666;">
                        04.12.2025
                    </td>
                </tr>

                {% endfor %}
            </tbody>
        </table>
    </div>

</div>
{% endblock %}